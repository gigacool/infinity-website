---
import type { GetStaticPaths } from 'astro';
import { Icon } from "astro-icon/components";
import Container from "@/components/container.astro";
import Sectionhead from "@/components/sectionhead.astro";
import Layout from "@/layouts/Layout.astro";
import { languages, getTranslations } from '@/i18n/utils';
import type { Language } from '@/i18n/utils';

export const prerender = true;

export const getStaticPaths = (() => {
  return languages.map((lang) => ({
    params: { lang },
  }));
}) satisfies GetStaticPaths;

const { lang } = Astro.params as { lang: Language };
const t = getTranslations(lang);

const useCases = [
  {
    title: t.features_page.uc1_title,
    points: [t.features_page.uc1_point1, t.features_page.uc1_point2, t.features_page.uc1_point3],
    icon: "bx:bxs-book-reader",
  },
  {
    title: t.features_page.uc2_title,
    points: [t.features_page.uc2_point1, t.features_page.uc2_point2, t.features_page.uc2_point3],
    icon: "bx:bxs-brain",
  },
  {
    title: t.features_page.uc3_title,
    points: [t.features_page.uc3_point1, t.features_page.uc3_point2, t.features_page.uc3_point3],
    icon: "bx:bxs-badge-check",
  },
  {
    title: t.features_page.uc4_title,
    points: [t.features_page.uc4_point1, t.features_page.uc4_point2, t.features_page.uc4_point3],
    icon: "bx:bxs-compass",
  },
];

const gridItems = [
  { title: t.features_page.grid_1, icon: "bx:bxs-bulb" },
  { title: t.features_page.grid_2, icon: "bx:bxs-bar-chart-alt-2" },
  { title: t.features_page.grid_3, icon: "bx:bxs-book-reader" },
  { title: t.features_page.grid_4, icon: "bx:bxs-trophy" },
  { title: t.features_page.grid_5, icon: "bx:bxs-time-five" },
  { title: t.features_page.grid_6, icon: "bx:bxs-badge-check" },
  { title: t.features_page.grid_7, icon: "bx:bxs-bot" },
  { title: t.features_page.grid_8, icon: "bx:bxs-dashboard" },
];

const siteUrl = "https://noosia.digital";

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": lang === 'fr' ? "Accueil" : "Home",
      "item": `${siteUrl}/${lang}/`
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": t.features_page.title
    }
  ]
};
---

<Layout lang={lang} title={t.features_page.title} description={t.features_page.meta_description}>
  <script slot="head" type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />

  <!-- Hero -->
  <Container>
    <Sectionhead>
      <Fragment slot="title">{t.features_page.hero_title}</Fragment>
      <Fragment slot="desc">{t.features_page.hero_description}</Fragment>
    </Sectionhead>
  </Container>

  <!-- Use-Case Sections -->
  {useCases.map((uc, i) => (
    <section class:list={[
      "py-16 md:py-20",
      i % 2 === 1 ? "bg-gray-50" : "bg-white"
    ]}>
      <Container>
        <div class="max-w-3xl mx-auto">
          <div class="flex items-center gap-4 mb-6">
            <div class="bg-noosia-orange/10 rounded-full p-3 w-12 h-12 flex items-center justify-center shrink-0">
              <Icon class="text-noosia-orange w-6 h-6" name={uc.icon} />
            </div>
            <h2 class="text-2xl md:text-3xl font-bold text-noosia-dark">
              {uc.title}
            </h2>
          </div>
          <ul class="space-y-3 ml-16">
            {uc.points.map((point) => (
              <li class="flex items-start gap-3 text-slate-700">
                <svg class="w-5 h-5 text-noosia-orange shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                <span>{point}</span>
              </li>
            ))}
          </ul>
        </div>
      </Container>
    </section>
  ))}

  <!-- Feature Grid -->
  <section class="py-16 md:py-20 bg-white">
    <Container>
      <h2 class="text-2xl md:text-3xl font-bold text-noosia-dark text-center mb-10">
        {t.features_page.grid_title}
      </h2>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 max-w-4xl mx-auto">
        {gridItems.map((item) => (
          <div class="flex flex-col items-center gap-2 p-4 rounded-lg bg-gray-50 text-center">
            <div class="bg-noosia-orange/10 rounded-full p-2 w-10 h-10 flex items-center justify-center">
              <Icon class="text-noosia-orange w-5 h-5" name={item.icon} />
            </div>
            <span class="text-sm font-medium text-noosia-dark">{item.title}</span>
          </div>
        ))}
        <div class="flex flex-col items-center justify-center gap-2 p-4 rounded-lg border-2 border-dashed border-gray-300 text-center">
          <span class="text-sm font-medium text-slate-500 italic">{t.features_page.grid_more}</span>
        </div>
      </div>
    </Container>
  </section>

  <!-- Beta CTA Section -->
  <section class="py-16 md:py-20">
    <Container>
      <div class="bg-noosia-dark p-8 md:px-20 md:py-16 mx-auto max-w-5xl rounded-lg flex flex-col items-center text-center">
        <h2 class="text-white text-3xl md:text-4xl font-bold tracking-tight">
          {t.features_page.beta_title}
        </h2>
        <p class="text-slate-300 mt-4 text-lg max-w-xl">
          {t.features_page.beta_desc}
        </p>
        <div class="mt-8">
          <a
            href={`/${lang}/beta`}
            class="bg-noosia-orange text-white px-8 py-4 rounded-full font-semibold text-lg hover:bg-orange-600 transition-colors inline-block"
          >
            {t.features_page.beta_cta}
          </a>
        </div>
      </div>
    </Container>
  </section>
</Layout>
